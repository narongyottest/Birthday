/* ฟอนต์และพื้นฐาน */
:root{
  --bg-1:#f7e1e6;
  --card-bg: rgba(255,255,255,0.7);
  --card-stroke: rgba(255,255,255,0.5);
  --text:#2b2b2b;
  --muted:#6c757d;
  --accent:#ff69b4;
  --accent-2:#e83e8c;
  --accent-3:#ffd1e6;
  --shadow: 0 20px 50px rgba(0,0,0,0.15);
}

.dark:root{
  --bg-1:#1b1220;
  --card-bg: rgba(30,22,35,0.75);
  --card-stroke: rgba(255,255,255,0.06);
  --text:#f1e8f4;
  --muted:#b9a9c2;
  --accent:#ff6fb9;
  --accent-2:#ff99cc;
  --accent-3:#3a253f;
  --shadow: 0 20px 50px rgba(0,0,0,0.5);
}

* { box-sizing: border-box; }
html,body { height: 100%; }
body{
  margin:0;
  font-family:'Mali', system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", sans-serif;
  color:var(--text);
  display:grid;
  place-items:center;
  padding:24px;
  background: var(--bg-1);
  overflow-x:hidden;
}

/* พื้นหลังไล่เฉด +ประกาย */
.bg-gradient{
  position:fixed; inset:0;
  background:
    radial-gradient(80vmax 80vmax at 10% -10%, #ffe7f1 0%, transparent 60%),
    radial-gradient(70vmax 70vmax at 110% 10%, #ffe3f4 0%, transparent 60%),
    radial-gradient(80vmax 80vmax at 50% 130%, #fff5fb 0%, transparent 60%);
  z-index:-2;
  filter:saturate(1.1);
}
.sparkles::before, .sparkles::after{
  content:"";
  position:fixed; inset:-20vmax;
  background:
    radial-gradient(circle at 10% 20%, rgba(255,255,255,.6) 0 3px, transparent 3px),
    radial-gradient(circle at 70% 80%, rgba(255,255,255,.45) 0 2px, transparent 2px),
    radial-gradient(circle at 30% 60%, rgba(255,255,255,.5) 0 2px, transparent 2px),
    radial-gradient(circle at 80% 30%, rgba(255,255,255,.35) 0 2px, transparent 2px);
  animation: twinkle 8s linear infinite;
  z-index:-1;
  pointer-events:none;
}
@keyframes twinkle{
  0%,100%{ transform:translateY(0); opacity:.8;}
  50%{ transform:translateY(-1.5%); opacity:1;}
}

/* ลูกโป่งลอย */
.balloons{
  position:fixed; left:0; right:0; top:0; height:100%;
  pointer-events:none; z-index:-1;
}
.balloon{
  position:absolute; bottom:-20vh; width:28px; height:36px; border-radius:14px 14px 22px 22px;
  background: var(--accent);
  box-shadow: inset -6px -10px 14px rgba(0,0,0,.08);
  animation: floatUp 14s linear infinite;
}
.balloon::after{
  content:""; position:absolute; left:50%; transform:translateX(-50%);
  bottom:-16px; width:2px; height:38vh; background: rgba(0,0,0,.06);
}
.b1{ left:8vw; animation-duration: 15s; background: #ff69b4;}
.b2{ left:28vw; animation-duration: 18s; background: #ffd166;}
.b3{ left:62vw; animation-duration: 16s; background: #7bdff2;}
.b4{ left:82vw; animation-duration: 19s; background: #cdb4db;}
@keyframes floatUp{
  0%{ transform: translateY(10vh) scale(1); opacity:0; }
  10%{ opacity:1; }
  100%{ transform: translateY(-120vh) scale(1.05); opacity:0; }
}

/* การ์ดแบบกลาส */
.birthday-card{
  width:min(720px, 100%);
  background: var(--card-bg);
  backdrop-filter: blur(12px) saturate(1.1);
  -webkit-backdrop-filter: blur(12px) saturate(1.1);
  border: 1px solid var(--card-stroke);
  border-radius: 24px;
  padding: clamp(20px, 4vw, 40px);
  text-align:center;
  box-shadow: var(--shadow);
  position:relative;
  overflow:hidden;
}

/* เฮดเดอร์ */
.main-title{
  font-size: clamp(2rem, 4.2vw, 3.2rem);
  margin: 0 0 .25em 0;
  color: var(--accent);
  text-shadow: 0 6px 20px rgba(255,105,180,.25);
}

/* ผู้รับ */
.recipient-name{
  color: var(--accent-2);
  font-weight:700;
  font-size: clamp(1.25rem, 2.6vw, 1.6rem);
  margin:.2em 0 1rem 0;
}

/* รูปภาพ */
.photo-wrap{
  margin: 10px auto 18px;
}
.birthday-photo{
  width: min(260px, 70%);
  aspect-ratio: 1 / 1;
  border-radius: 22px;
  object-fit: cover;
  border: 6px solid var(--accent-3);
  box-shadow: 0 10px 30px rgba(0,0,0,.12);
  transition: transform .35s ease, box-shadow .35s ease;
}
.birthday-photo:hover{
  transform: translateY(-4px) rotate(-1.5deg);
  box-shadow: 0 18px 44px rgba(0,0,0,.18);
}
.photo-wrap figcaption{
  margin-top:.5rem; color:var(--muted); font-size:.95rem;
}

/* กล่องข้อความ */
.message-box{
  background: linear-gradient(180deg, rgba(255,255,255,.6), rgba(255,255,255,.4));
  border: 2px dashed var(--accent);
  border-radius: 14px;
  padding: clamp(14px, 2.4vw, 22px);
  text-align: left;
  line-height: 1.75;
  color: var(--text);
  margin: 16px 0 22px;
}

/* ผู้ส่ง */
.sender-name{
  color:var(--muted);
  font-style: italic;
  margin: 6px 0 18px;
}

/* ปุ่ม */
.actions{
  display:flex; gap:10px; justify-content:center; flex-wrap:wrap;
}
.btn{
  appearance:none; border:0; cursor:pointer;
  padding: 10px 16px;
  border-radius: 999px;
  background: var(--accent);
  color:white; font-weight:700;
  box-shadow: 0 10px 20px rgba(255,105,180,.3);
  transition: transform .12s ease, filter .2s ease, box-shadow .2s ease;
}
.btn:hover{ transform: translateY(-1px); filter: brightness(1.02); }
.btn:active{ transform: translateY(0); filter: brightness(.98); }
.btn.ghost{
  background: transparent; color: var(--accent);
  border: 2px solid var(--accent);
  box-shadow:none;
}

/* คอนเฟ็ตติ */
.confetti{
  --x: 50vw; /* กำหนดด้วย JS */
  --size: 8px; /* กำหนดด้วย JS */
  --rot: 0deg; /* กำหนดด้วย JS */
  --delay: 0s; /* กำหนดด้วย JS */

  position: fixed;
  left: var(--x);
  top: -10vh;
  width: var(--size);
  height: var(--size);
  background: currentColor;
  transform: rotate(var(--rot));
  border-radius: 2px;
  animation: fall 1.1s var(--delay) ease-out forwards;
  color: hsl(calc(360 * var(--x) / 100), 90%, 60%);
  z-index: 9999;
}
@keyframes fall{
  0%{ transform: translate(-50%, -20vh) rotate(var(--rot)); opacity:1; }
  100%{ transform: translate(-50%, 110vh) rotate(calc(var(--rot) + 180deg)); opacity:0; }
}

/* วิดีโอในการ์ด */
.birthday-video{
  width: clamp(160px, 40vw, 260px);  /* ต่ำสุด 240px, ปรับตามจอถึงไม่เกิน 360px */
  max-height: 70vh;
  border-radius: 16px;
  border: 4px solid var(--accent-3);
  margin: 10px auto 0;
  display: block;
  background: #000;
}


/* ลดแอนิเมชันเมื่อผู้ใช้ไม่ต้องการ */
@media (prefers-reduced-motion: reduce){
  .balloon, .sparkles::before, .sparkles::after, .confetti{ animation: none !important; }
}

/* =========================
   KUROMI THEME (toggle by .kuromi on <html>)
   ========================= */
.kuromi:root{
  --bg-1:#1f1827;             /* ดำอมม่วง */
  --card-bg: rgba(36, 28, 47, 0.78);
  --card-stroke: rgba(255,255,255,0.08);
  --text:#f7ecff;             /* ขาวอมม่วง */
  --muted:#cbb7da;            /* ม่วงอ่อนซอฟต์ */
  --accent:#ff7bb1;           /* ชมพูคุโรมิ */
  --accent-2:#e5a6ff;         /* ม่วงพาสเทล */
  --accent-3:#2a2236;         /* เส้นขอบ/กรอบ */
  --shadow: 0 24px 60px rgba(0,0,0,0.55);
}

/* พื้นหลัง: ม่วงเข้ม + โทนกลาส */
.kuromi .bg-gradient{
  background:
    radial-gradient(70vmax 70vmax at 15% -10%, #2b203c 0%, transparent 60%),
    radial-gradient(70vmax 70vmax at 110% 10%, #2a1f3b 0%, transparent 60%),
    radial-gradient(80vmax 80vmax at 50% 120%, #2a1f39 0%, transparent 60%);
  filter:saturate(1.05) contrast(1.02);
}

/* ลายอาร์ไกล์จาง ๆ บนประกาย */
.kuromi .sparkles::before,
.kuromi .sparkles::after{
  background:
    linear-gradient(45deg, rgba(229,166,255,.08) 25%, transparent 25%) 0 0/32px 32px,
    linear-gradient(-45deg, rgba(229,166,255,.08) 25%, transparent 25%) 0 0/32px 32px,
    linear-gradient(45deg, transparent 75%, rgba(255,123,177,.08) 75%) 0 0/32px 32px,
    linear-gradient(-45deg, transparent 75%, rgba(255,123,177,.08) 75%) 0 0/32px 32px;
  animation: twinkle 10s linear infinite;
}

/* ลูกโป่งคุมโทนคุโรมิ */
.kuromi .b1{ background:#ff7bb1; }
.kuromi .b2{ background:#8a6adf; }
.kuromi .b3{ background:#2a2236; }
.kuromi .b4{ background:#e5a6ff; }

/* การ์ด: ขอบหวาน ๆ + สติกเกอร์หัวกะโหลกบนมุม */
.kuromi .birthday-card{
  border: 1px solid rgba(255,255,255,0.12);
  position:relative;
  overflow:hidden;
}
.kuromi .birthday-card::after{
  /* สติกเกอร์หัวกะโหลกคุโรมิ (SVG ฝัง) */
  content:"";
  position:absolute; top:-14px; right:-14px;
  width:84px; height:84px; transform: rotate(12deg);
  background:
    radial-gradient(circle at 60% 38%, rgba(0,0,0,.35) 0 30%, transparent 31%),
    url("data:image/svg+xml;utf8,\
<svg xmlns='http://www.w3.org/2000/svg' width='96' height='96' viewBox='0 0 96 96'>\
<g fill='none' stroke='none'>\
<circle cx='48' cy='48' r='44' fill='%23ff7bb1' opacity='0.2'/>\
<path d='M48 18c-10 0-20 8-22 18-2 9 3 18 12 22l-2 10 12-6 12 6-2-10c9-4 14-13 12-22-2-10-12-18-22-18z' fill='%23f6e9f6'/>\
<circle cx='38' cy='44' r='5' fill='%23130f1a'/>\
<circle cx='58' cy='44' r='5' fill='%23130f1a'/>\
<rect x='44' y='56' width='8' height='6' rx='2' fill='%23130f1a'/>\
<path d='M48 26 l-8 8 8-3 8 3 -8-8z' fill='%232a2236'/>\
</g></svg>") center / contain no-repeat;
  filter: drop-shadow(0 8px 14px rgba(0,0,0,.35));
  pointer-events:none;
}

/* หัวข้อและชื่อผู้รับโทนชมพู/ม่วง */
.kuromi .main-title{
  color: var(--accent);
  text-shadow: 0 8px 26px rgba(255,123,177,.35);
}
.kuromi .recipient-name{
  color: var(--accent-2);
}

/* กรอบรูปและป้ายใต้รูป */
.kuromi .birthday-photo{
  border-color:#3a2b4f;
  box-shadow: 0 14px 36px rgba(0,0,0,.28);
}
.kuromi .photo-wrap figcaption{
  color:#d9c8ea;
}

/* กล่องข้อความ: ไล่เฉดเบา ๆ + เส้นประชมพู */
.kuromi .message-box{
  background: linear-gradient(180deg, rgba(255,255,255,.14), rgba(255,255,255,.08));
  border: 2px dashed #ff7bb1;
}

/* ปุ่ม: ชมพูคุโรมิ + Ghost */
.kuromi .btn{
  background: #ff7bb1;
  box-shadow: 0 12px 22px rgba(255,123,177,.3);
}
.kuromi .btn.ghost{
  background: transparent; color: #ff7bb1;
  border: 2px solid #ff7bb1;
}

/* คอนเฟ็ตติ — โทนชมพู/ม่วง */
.kuromi .confetti{
  color: hsl(calc(300 + (60 * var(--x) / 100)), 80%, 65%);
}
